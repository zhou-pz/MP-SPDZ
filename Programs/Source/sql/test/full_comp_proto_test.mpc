from Compiler.library import *
from Compiler.sql.full_comp_proto import *

def Orderby_test():
    n = 8
    a = 4
    limit = 4
    data = [
        [5, 1, 6, 1, 3, 4, 3, 10],
        [1, 1, 1, 0, 1, 1, 0, 1],
        [5, 1, 6, 1, 3, 4, 3, 10],
        [50, 10, 60, 10, 30, 40, 30, 100]
    ]
    T = Matrix(a, n, sint)
    T.assign(data)
    D = Orderby(T, limit)
    print_ln("Orderby result:")
    D.print_reveal_nested()

def Groupby_test():
    n = 8
    a = 4
    data = [
        [5, 1, 6, 1, 3, 4, 3, 10],
        [1, 1, 1, 0, 1, 1, 0, 1],
        [5, 1, 6, 1, 3, 4, 3, 10],
        [50, 10, 60, 10, 30, 40, 30, 100]
    ]
    T = Matrix(a, n, sint)
    T.assign(data)
    G = Groupby(T)
    print_ln("Orderby result:")
    G.print_reveal_nested()

def Join_test():
    data_A = [
        [5, 1, 6, 2, 7, 4, 3, 10],
        [1, 1, 1, 1, 1, 1, 0, 1],
        [50, 10, 60, 20, 70, 40, 30, 100],
        [500, 100, 600, 200, 700, 400, 300, 1000]
    ]
    data_B = [
        [4, 1, 6, 8, 7, 9, 11],
        [1, 1, 1, 0, 1, 1, 1],
        [41, 11, 61, 81, 71, 91, 111],
        [411, 111, 611, 811, 711, 911, 1111],
        [4111, 1111, 6111, 8111, 7111, 9111, 11111]
    ]
    a_A, n_A = 4, 8
    a_B, n_B = 5, 7
    A = Matrix(a_A, n_A, sint)
    A.assign(data_A)
    B = Matrix(a_B, n_B, sint)
    B.assign(data_B)
    print_ln("A:")
    A.print_reveal_nested()
    print_ln("B:")
    B.print_reveal_nested()
    J = Join(A, B)
    print_ln("Join result:")
    J.transpose().print_reveal_nested()

# Join_test()

n = 10**7
a = sint.Array(n)
b = sint.Array(n)

c = a[:] > b[:]